{"ts":1340896501140,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"import os\nimport wsgiref.handlers\nfrom xml.dom import minidom\n\nfrom google.appengine.ext.webapp import template\nfrom google.appengine.ext import webapp\nfrom google.appengine.api import urlfetch\n\nBASE_URL = \"https://ghicalls.appspot.com/\"\n\nclass ForwardCall(webapp.RequestHandler):\n    \"\"\"\n    Accepts input digits from the caller and forwards the call\n    \"\"\"\n    def get(self):\n        self.post()\n    \n    def _error(self, msg, redirecturl=None):\n        templatevalues = {\n            'msg': msg,\n            'redirecturl': redirecturl\n        }\n        xml_response(self, 'error.xml', templatevalues)\n\n    def post(self):\n        forward = self.request.get('Digits')\n        if forward:\n            try:\n                forward = int(forward)\n\n                if forward == 1:\n                    number = \"919-438-2444\"\n                elif forward == 2:\n                    number = \"919-438-2444\"\n                else:\n                    raise\n            \n                xml_response(self, 'forward.xml', {\"number\" : number})\n\n            except:\n                self._error(\"Sorry, I didn't recognize the number you entered.\", BASE_URL)\n\n        else:\n            self._error(\"Sorry, I didn't recognize the number you entered.\", BASE_URL)\n\n\n# @start snippet\ndef xml_response(handler, page, templatevalues=None):\n    \"\"\"\n    Renders an XML response using a provided template page and values\n    \"\"\"\n    path = os.path.join(os.path.dirname(__file__), page)\n    handler.response.headers[\"Content-Type\"] = \"text/xml\"\n    handler.response.out.write(template.render(path, templatevalues))\n\nclass GatherPage(webapp.RequestHandler):\n    \"\"\"\n    Initial user greeting.  Plays the welcome audio file then reads the\n    \"enter zip code\" message.  The Play and Say are wrapped in a Gather\n    verb to collect the 5 digit zip code from the caller.  The Gather\n    will post the results to /weather\n    \"\"\"\n    def get(self):\n        self.post()\n    \n    def post(self):\n        templatevalues = {\n            'postprefix': BASE_URL,\n        }\n        # xml_response(self, 'gather.xml', templatevalues)\n        xml_response(self, 'directoffice.xml', templatevalues)\n# @end snippet\n\ndef main():\n\t# @start snippet\n    application = webapp.WSGIApplication([ \\\n        ('/', GatherPage),\n        ('/forward', ForwardCall)],\n        debug=True)\n    # @end snippet\n    wsgiref.handlers.CGIHandler().run(application)\n\nif __name__ == \"__main__\":\n    main()\n"]],"start1":0,"start2":0,"length1":0,"length2":2446}]],"length":2446}
{"contributors":[],"silentsave":false,"ts":1344640462011,"patch":[[{"diffs":[[0,"ing."],[-1,"  Plays the welcome audio file then reads the\n    \"enter zip code\" message.  The Play and Say are wrapped in a Gather\n    verb to collect the 5 digit zip code from the caller.  The Gather\n    will post the results to /weather"],[0,"\n   "]],"start1":1666,"start2":1666,"length1":233,"length2":8}]],"length":2221,"saved":false}
